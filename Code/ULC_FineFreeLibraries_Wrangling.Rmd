---
title: "FineFree"
author: "ODL"
date: "8/6/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(shiny)
library(jsonlite)
library(dplyr)
library(tidyr)
library(ggplot2)
library(lubridate)
library(curl)
```

```{r}
#From these instructions: #https://stackoverflow.com/questions/50161492/how-do-i-scrape-data-from-an-arcgis-online-map
#I deduced: https://www.arcgis.com/sharing/rest/content/items/28e5da03800d419bb0c1170d98595b2c/data

df <- jsonlite::fromJSON("https://www.arcgis.com/sharing/rest/content/items/28e5da03800d419bb0c1170d98595b2c/data") 
```

```{r}
ULC_FineFree_DF <- df[["operationalLayers"]][["featureCollection"]][["layers"]][[1]][["featureSet"]][["features"]][[1]][["attributes"]] %>% 
  as.data.frame
```

```{r}
ULC_FineFree_DF %>% 
  select(library_name, ulc_member, type_of_elimintation, reason_for_stopping_fines, lat, long, source, policy_notes) %>%
  write.csv(paste("~/Documents/GitHub/FinesAndFees/Data/ULC_FineFreeLibraries_",format(Sys.time(), "%Y-%m-%d"),".csv", sep=""))
```



